% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PathwayAnalysis.R
\name{RunRAMPgeseca}
\alias{RunRAMPgeseca}
\title{Runs multilevel Monte-Carlo variant for performing gene sets co-regulation analysis using the RAMP_DB metabolite/gene database.}
\usage{
RunRAMPgeseca(
  E,
  minSize = 1,
  maxSize = nrow(E) - 1,
  center = TRUE,
  scale = FALSE,
  sampleSize = 101,
  eps = 1e-50,
  nproc = 0,
  BPPARAM = NULL,
  nPermSimple = 1000
)
}
\arguments{
\item{E}{expression matrix, rows corresponds to RAMP_IDs, columns corresponds to cell barcodes.}

\item{minSize}{Minimal size of a gene set to test. All pathways below the threshold are excluded (default = 1).}

\item{maxSize}{Maximal size of a gene set to test. All pathways above the threshold are excluded (default = \code{nrow(E) - 1}).}

\item{center}{a logical value indicating whether the gene expression should be centered to have zero mean before the analysis takes place (default = TRUE).}

\item{scale}{a logical value indicating whether the gene expression should be scaled to have unit variance before the analysis takes place (default = FALSE).}

\item{sampleSize}{sample size for conditional sampling (default = 101).}

\item{eps}{This parameter sets the boundary for calculating P-values (default = 1e-50).}

\item{nproc}{If not equal to zero sets BPPARAM to use nproc workers (default = 0).}

\item{BPPARAM}{Parallelization parameter used in bplapply (default = NULL).}

\item{nPermSimple}{Number of permutations in the simple geseca implementation for preliminary estimation of P-values (default = 1000).}
}
\value{
A table with GESECA results. Each row corresponds to a tested RAMP_DB pathway.
}
\description{
This function is adapted from the \href{https://github.com/alserglab/fgsea/blob/master/R/geseca-multilevel.R}{fgsea::geseca} package to identify significantly expressed RAMP_DB pathways based on an expression/feature embedding matrix.
}
\examples{
# E <- SpaMTP@reductions$pca.rev@feature.loadings
# sig_pathways <- RunRAMPgeseca(E, minSize=15, maxSize=500)
}
