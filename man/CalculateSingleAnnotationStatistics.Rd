% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PathwaybasedAnnotationStatistics.R
\name{CalculateSingleAnnotationStatistics}
\alias{CalculateSingleAnnotationStatistics}
\title{Calculate annotation statistics for a single m/z value suggesting the most likely metabolite based on correlated pathway expression.}
\usage{
CalculateSingleAnnotationStatistics(
  mz,
  data,
  mz.assay,
  pathway.assay = "pathway",
  mz.slot = "scale.data",
  pathway.slot = "scale.data",
  corr_theshold = 0,
  corr_weight = 1,
  n_weight = 1
)
}
\arguments{
\item{mz}{Character or numeric. The target m/z feature. If numeric, the closest matching m/z in the dataset will be selected.}

\item{data}{A SpaMTP Seurat object containing both metabolite and pathway assays generated from \code{CreatePathwayObject}.}

\item{mz.assay}{Character string defining the name of the assay containing m/z features.}

\item{pathway.assay}{Character string matching the name of the assay containing pathway features (default = "pathway").}

\item{mz.slot}{Character string stating the slot to extract m/z values from (default = "scale.data").}

\item{pathway.slot}{Character string defining the slot to extract pathway features from (default = "scale.data").}

\item{corr_theshold}{Numeric value stating the correlation threshold to consider a pathway as significantly colocalized. If set to \code{0}, all pathways will be counted (default = 0).}

\item{corr_weight}{Numeric weight applied to correlation score in z-score calculation. If significance should be based more on the correlation, increase this value (default = 1).}

\item{n_weight}{Numeric weight applied to number of correlated pathways in z-score calculation (default = 1).}
}
\value{
A tibble with the ranked annotations for the m/z value, containing:
\describe{
\item{metabolite}{Most common name of the metabolite associated with the RAMP ID}
\item{ramp_id}{The RAMP ID corresponding to the annotation}
\item{n_sig_path}{Number of correlated pathways above the threshold}
\item{max_cor}{Maximum correlation value among significant pathways}
\item{z_score}{Combined z-score used to rank annotations}
\item{pval}{Unadjusted p-value}
\item{pval_adj}{Adjusted p-value (BH method)}
}
}
\description{
This function evaluates the potential biological relevance of an annotation for a given m/z value by:
\itemize{
\item Identifying pathways associated with each possible annotated metabolite
\item Calculating colocalisation score between the m/z intensity and the expression of each corresponding pathway
\item Ranking annotations by a combined z-score based on correlation strength and number of supporting significant pathways
\item NOTE: this function requires \code{CreatePathwayAssay} and \code{CreatePathwayObject} to be run first
}
}
