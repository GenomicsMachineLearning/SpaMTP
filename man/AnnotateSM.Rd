% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MZAnnotation.R
\name{AnnotateSM}
\alias{AnnotateSM}
\title{Annotates m/z values based on reference metabolite dataset}
\usage{
AnnotateSM(
  data,
  db,
  assay = "Spatial",
  raw.mz.column = "raw_mz",
  ppm_error = NULL,
  adducts = NULL,
  polarity = "positive",
  tof_resolution = 30000,
  filepath = NULL,
  return.only.annotated = TRUE,
  save.intermediate = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{data}{Seurat Spatial Metabolomic Object containing m/z values for annotation.}

\item{db}{Reference metabolite dataset in the form of a Data.Frame.}

\item{assay}{Character string defining the Seurat assay which contains the mz counts being annotated (default = "Spatial").}

\item{raw.mz.column}{Character string defining the Seurat assay slot which contains the raw mz values, this is without the 'mz-' and are a vector of integers. This is setup by default when running the cardinal_to_seurat() function (default = "raw_mz").}

\item{ppm_error}{Numeric value indicating the size of the ppm error allowed when matching molecular weights between Seurat object and reference dataset. If only want exact matches set ppm = 0 (default = NULL).}

\item{adducts}{List of adducts to use for searching the database (e.g. "M+NH4","M+Na","M+CH3OH+H","M+K" etc.). For all possible adducts please visit \href{https://github.com/GenomicsMachineLearning/SpaMTP/blob/main/R/MZAnnotation.R#L305}{here}. If NULL will take the full list of adducts (default = NULL).}

\item{polarity}{Character string defining the polarity of adducts to use, either "positive", "negative" or "neutral" (default = "positive").}

\item{tof_resolution}{is the tof resolution of the instrument used for MALDI run, calculated by ion \verb{[ion mass,m/z]}/\verb{[Full width at half height]}. This value is used to estimate ppm_error when set to NULL (default = 30000).}

\item{filepath}{Character string of the directory to store the _annotated_mz_peaks.csv. Else, set to NULL as default.}

\item{return.only.annotated}{Boolean value indicating if the annotated Seurat Object should only include m/z values that were successfully annotated (default = TRUE).}

\item{save.intermediate}{Boolean indicating whether to save an intermediate file in the \verb{@tools} slot of the SpaMTP object required for later analysis functions such as \code{FindRegionalPathways()} (default = TRUE).}

\item{verbose}{Boolean indicating whether to show the message. If TRUE the message will be show, else the message will be suppressed (default = TRUE).}
}
\value{
A Seurat Object with m/z values annotated. These annotations are stored in the relative assay's meta.data (e.g. SeuratObj\verb{[["Spatial"]][[]]})
}
\description{
Annotates m/z values based on reference metabolite dataset
}
\examples{
# HMDB_db <- load("data/HMDB_1_names.rds")
# Annotated_SeuratObj <- AnnotateSM(SeuratObj, HMDB_db)
}
