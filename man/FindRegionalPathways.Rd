% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PathwayAnalysis.R
\name{FindRegionalPathways}
\alias{FindRegionalPathways}
\title{This the function used to compute the exact fisher test for over-representation based pathway analysis}
\usage{
FindRegionalPathways(
  SpaMTP,
  polarity,
  adduct = NULL,
  analyte_types = c("gene", "metabolites"),
  spatial_metabolomic_assay = "SPM",
  spatial_transcriptomic_assay = "SPT",
  slot = "counts",
  npcs = 30,
  resolution = 0.5,
  algorithm = 1,
  test_use = "wilcox",
  st_cluster_name = "ST_clusters",
  sm_cluster_name = "SM_clusters",
  tof_resolution = 30000,
  min_path_size = 5,
  max_path_size = 500,
  cluster_vector = NULL,
  background_cluster = NULL,
  ppm_error = NULL,
  pval_cutoff_pathway = NULL,
  pval_cutoff_mets = NULL,
  pval_cutoff_genes = NULL,
  verbose = T,
  ...
)
}
\arguments{
\item{SpaMTP}{A seurat object contains spatial metabolomics/transcriptomics features or both.}

\item{polarity}{The polarity of the spatial metabolomics experiment. Inputs must be either NULL, 'positive' or 'negative'. If NULL, pathway analysis will run in neutral mode (default = NULL).}

\item{adduct}{A vector subset of SpaMTP::adduct_file$adduct_name, e.g. c("M+K","M+H "), default will take the full list of SpaMTP::adduct_file$adduct_name}

\item{analyte_types}{A subset of c("gene", "metabolites"), can be c("gene"), c("metabolites") or both}

\item{spatial_metabolomic_assay}{A Character string defining descrbing slot name for spatial metabolomics data in SpaMTP to extract intensity values from, default is "SPM"}

\item{spatial_transcriptomic_assay}{A Character string defining descrbing slot name for spatial transcriptomics data in SpaMTP to extract RNA count values from(default = "SPT").}

\item{slot}{The slot name in each assay to access the matrix data of each omics, default is "count"}

\item{npcs}{A numerical integer, representing the number of principle components that the PCA will reduce to.}

\item{resolution}{Goes to seurat::FindClusters Value of the resolution parameter, use a value above (below) 1.0 if you want to obtain a larger (smaller) number of communities.}

\item{algorithm}{Algorithm for modularity optimization (1 = original Louvain algorithm; 2 = Louvain algorithm with multilevel refinement; 3 = SLM algorithm; 4 = Leiden algorithm). Leiden requires the leidenalg python}

\item{st_cluster_name}{A character to describe the clustered result for spatial transcriptomics if the cluster haven't been done}

\item{sm_cluster_name}{A character to describe the clustered result for spatial metabolomics  if the cluster haven't been done"}

\item{tof_resolution}{is the tof resolution of the instrument used for MALDI run, calculated by ion \verb{[ion mass,m/z]}/\verb{[Full width at half height]} (default = 30000).}

\item{min_path_size}{The min number of metabolites in a specific pathway (default = 5).}

\item{max_path_size}{The max number of metabolites in a specific pathway (default = 500).}

\item{cluster_vector}{A factor vector where each levels indicates the different clustered regions in tissue}

\item{background_cluster}{A vector consist of 0 and 1, where 1 indicates the intended background region}

\item{ppm_error}{A numerical value, standing for the parts-per-million error tolerance of matching m/z value with potential metabolites (default = NULL, calculated by )}

\item{pval_cutoff_pathway}{A numerical value between 0 and 1 describe the cutoff adjusted p value for the permutation test used to compute output pathways}

\item{pval_cutoff_mets}{A numerical value between 0 and 1 describe the cutoff adjusted p value for the differential expression analysis for metabolites}

\item{pval_cutoff_genes}{A numerical value between 0 and 1 describe the cutoff adjusted p value for the differential expression analysis for RNAs}

\item{verbose}{A boolean value indicates whether verbose is shown}

\item{...}{The other parameters goes to Seurat methods}
}
\value{
A SpaMTP object with set enrichment on given analyte types.
}
\description{
This the function used to compute the exact fisher test for over-representation based pathway analysis
}
\examples{
# SpaMTP = FindRegionalPathways(SpaMTP, polarity = "positive")
}
